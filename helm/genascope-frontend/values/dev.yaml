# Development environment configuration
config:
  # Backend URL for server-side proxy (Kubernetes internal DNS)
  backendUrl: "http://genascope-backend.dev.svc.cluster.local:80"
  nodeEnv: "development"

# Development - More permissive for testing
networkPolicy:
  enabled: true
  ingressNamespace: "ingress"
  allowExternalHTTPS: true
  allowedNamespaces:
    - "kube-system"      # For debugging tools
    - "monitoring"       # If you have monitoring
  backendNamespaces:
    - "dev"              # Backend services in dev namespace
    - "shared-services"  # Shared services if any

replicaCount: 2

image:
  tag: "latest"
  pullPolicy: Always

resources:
  limits:
    cpu: 200m
    memory: 256Mi
  requests:
    cpu: 50m
    memory: 64Mi

probes:
  liveness:
    initialDelaySeconds: 10
  readiness:
    initialDelaySeconds: 5

ingress:
  enabled: true
  className: "public"
  annotations:
    nginx.ingress.kubernetes.io/proxy-body-size: "10m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-connect-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-next-upstream-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-buffering: "off"
    nginx.ingress.kubernetes.io/upstream-keep-alive-timeout: "300"
    nginx.ingress.kubernetes.io/configuration-snippet: |
      # Only apply no-cache headers to API routes, not static assets
      location ~* ^/api/ {
        more_set_headers "Cache-Control: no-cache, no-store, must-revalidate" always;
        more_set_headers "Pragma: no-cache" always;
        more_set_headers "Expires: 0" always;
      }
      # Allow normal caching for static assets
      location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        more_set_headers "Cache-Control: public, max-age=31536000, immutable" always;
      }
  hosts:
    - host: genascope-dev.local
      paths:
        - path: /
          pathType: Prefix
    - host: chat-dev.genascope.com
      paths:
        - path: /
          pathType: Prefix

# Backend service configuration for API routing
backend:
  enabled: true
  serviceName: "genascope-backend"
  servicePort: 80
